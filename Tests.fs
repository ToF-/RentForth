\ Tests.fs
INCLUDE ffl/tst.fs
INCLUDE Rent.fs

: TEST-VALUE-TABLE
    42 4807 UPDATE-VALUE
    T{ 4807 GET-VALUE -1 ?S  42 ?S }T
    43 4807 UPDATE-VALUE
    T{ 4807 GET-VALUE -1 ?S  43 ?S }T
    41 4807 UPDATE-VALUE
    T{ 4807 GET-VALUE -1 ?S  43 ?S }T
;

VARIABLE V

: TEST-UPDATE-MAX
    0 V !
    10 V UPDATE-MAX
    T{ V @ 10 ?S }T 
    5 V UPDATE-MAX
    T{ V @ 10 ?S }T 
;

: TEST-ONE-ORDER
    INIT-VALUES
    0 5 10 ADD-ORDER
    T{ MAXIMUM-VALUE @ 10 ?S }T ;
    
: TEST-TWO-COLLAPSING-ORDERS
    INIT-VALUES
    0 5 14 ADD-ORDER
    3 7 10 ADD-ORDER
    T{ MAXIMUM-VALUE @ 14 ?S }T ;

: TEST-TWO-FOLLOWING-ORDERS
    INIT-VALUES
    0 5 10 ADD-ORDER
    5 9  7 ADD-ORDER
    T{ MAXIMUM-VALUE @ 17 ?S }T ;

: TESTS
    TEST-VALUE-TABLE
    TEST-UPDATE-MAX
    TEST-ONE-ORDER
    TEST-TWO-COLLAPSING-ORDERS
    TEST-TWO-FOLLOWING-ORDERS
;

TESTS
." success"
BYE
