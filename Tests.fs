\ Tests.fs

INCLUDE ffl/tst.fs
INCLUDE ffl/hct.fs
INCLUDE Rent.fs

: TEST-INITIALIZE
    INIT-RENT
    T{ RENT-VALUE @ 0 ?S }T 
    T{ RENT-VALUES HCT-LENGTH@ 0 ?S }T
    42 S" FOO" RENT-VALUES HCT-INSERT
    INIT-RENT
    T{ RENT-VALUES HCT-LENGTH@ 0 ?S }T
;

: TEST-RENT
    INIT-RENT
    0 5 10 RENT
    T{ 5 RENT-VALUE@ 10 ?S }T 
;
 
: TEST-ONE-ORDER
    INIT-RENT
    0 5 10 RENT
    5 COLLECT
    T{ RENT-VALUE @ 10 ?S }T 
;

: TEST-TWO-COLLIDING-ORDERS
    INIT-RENT
    0 5 14 RENT
    3 7 10 RENT
    5  COLLECT
    10 COLLECT
    T{ RENT-VALUE @ 14 ?S }T
;
: TEST-TWO-COMPATIBLE-ORDERS
    INIT-RENT
    0 5 10 RENT
    5 COLLECT
    6 9 7  RENT
    14 COLLECT
    T{ RENT-VALUE @ 17 ?S }T
;
: TEST-DEMO-CASE
    INIT-RENT
    0 5 10 RENT
    3 7 14 RENT
    5  COLLECT
    5 9  7 RENT
    6 9  8 RENT
    10 COLLECT
    14 COLLECT
    15 COLLECT
    T{ RENT-VALUE @ 18 ?S }T
;

TEST-INITIALIZE
TEST-RENT
TEST-ONE-ORDER
TEST-TWO-COLLIDING-ORDERS
TEST-TWO-COMPATIBLE-ORDERS
TEST-DEMO-CASE

BYE

