\ Tests.fs
REQUIRE ffl/tst.fs
REQUIRE Rent.fs

: TEST-PLAN
    INITIALIZE
    5 10 RENT
    T{ 5 PLAN@ 10 ?S }T 
    5 CASH
    T{ RENT-VALUE @ 10 ?S }T
    12 7 RENT
    T{ 12 PLAN@ 17 ?S }T
    12 5 RENT
    T{ 12 PLAN@ 17 ?S }T 
    12 CASH
    T{ RENT-VALUE @ 17 ?S }T ; 

: TEST-DO-ACTION
    INITIALIZE
    0  5     10 DO-ACTION
    3  10    14 DO-ACTION
    5  0  CASH% DO-ACTION
    5  14     7 DO-ACTION
    6  15     8 DO-ACTION
    10 0  CASH% DO-ACTION
    14 0  CASH% DO-ACTION
    15 0  CASH% DO-ACTION
    T{ RENT-VALUE @ 18 ?S }T ;

: TEST-ACTION>KEY
    3 5 7 ACTION>KEY [ HEX ] 
    T{ C0000A00007 ?S }T [ DECIMAL ] ; 

: TEST-KEY>ACTION
    3 5 7 ACTION>KEY KEY>ACTION
    T{ 7 ?S 5 ?S 3 ?S }T ;
    
: TEST-ACTION
    SWAP DROP KEY>ACTION ;

: TEST-ADD-ORDER
    INITIALIZE
    0 5 10 ADD-ORDER
    T{ ACTIONS ACT-LENGTH@ 2 ?S }T 
    ['] TEST-ACTION ACTIONS ACT-EXECUTE 
    T{ 0 ?S 0 ?S 5 ?S 10 ?S 5 ?S 0 ?S }T ;

: TEST-COMPUTE-RENT-VALUE
    INITIALIZE
    0 5 10 ADD-ORDER
    3 7 14 ADD-ORDER
    5 9  7 ADD-ORDER
    6 9  8 ADD-ORDER 
    T{ COMPUTE-VALUE 18 ?S }T ;
TEST-PLAN
TEST-DO-ACTION
TEST-ACTION>KEY
TEST-KEY>ACTION
TEST-ADD-ORDER
TEST-COMPUTE-RENT-VALUE


BYE

