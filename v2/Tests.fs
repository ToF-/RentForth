\ Tests.fs
INCLUDE ffl/tst.fs
INCLUDE Rent.fs

: TEST-VALUE-TIME-TABLE
    INITIALIZE
    42 4807 UPDATE-VALUE
    T{ 4807 GET-VALUE 42 ?S }T
    43 4807 UPDATE-VALUE
    T{ 4807 GET-VALUE 43 ?S }T
    41 4807 UPDATE-VALUE
    T{ 4807 GET-VALUE 43 ?S }T
;

VARIABLE V

: TEST-UPDATE-VARIABLE
    INITIALIZE
    0 V !
    10 V UPDATE-VARIABLE
    T{ V @ 10 ?S }T 
    5 V UPDATE-VARIABLE
    T{ V @ 10 ?S }T 
;

: TEST-ADD-ORDER
    INITIALIZE
    0 5 10 ADD-ORDER
    T{ MAXIMUM @ 10 ?S }T
    3 7 14 ADD-ORDER
    T{ MAXIMUM @ 14 ?S }T
    5 9 7 ADD-ORDER
    T{ MAXIMUM @ 17 ?S }T
    6 9 8 ADD-ORDER
    T{ MAXIMUM @ 18 ?S }T
    10 3 7 ADD-ORDER
    T{ MAXIMUM @ 21 ?S }T
;

: TEST-TWO-COLLAPSING-ORDERS
    INITIALIZE
    0 5 14 ADD-ORDER
    3 7 10 ADD-ORDER
    T{ MAXIMUM @ 14 ?S }T ;

: TEST-TWO-FOLLOWING-ORDERS
    INITIALIZE
    0 5 10 ADD-ORDER
    5 9  7 ADD-ORDER
    T{ MAXIMUM @ 17 ?S }T ;

: TESTS
    TEST-VALUE-TIME-TABLE
    TEST-UPDATE-VARIABLE
    TEST-ADD-ORDER
    TEST-TWO-COLLAPSING-ORDERS
    TEST-TWO-FOLLOWING-ORDERS
;
PAGE
TESTS
BYE
